{% extends "base.html" %}

{% block title %}Add User - Admin{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title mb-0">
                        <i class="fas fa-user-plus me-2"></i>
                        Add New User
                    </h4>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <!-- Basic Information -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="email" class="form-label">Email Address <span class="text-danger">*</span></label>
                                <input type="email" class="form-control" id="email" name="email" required>
                                <div class="form-text">This will be the user's login email</div>
                            </div>
                            <div class="col-md-6">
                                <label for="organization_id" class="form-label">Organization</label>
                                <select class="form-select" id="organization_id" name="organization_id">
                                    <option value="">Select Organization</option>
                                    {% for org in organizations %}
                                    <option value="{{ org.id }}">{{ org.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="first_name" class="form-label">First Name</label>
                                <input type="text" class="form-control" id="first_name" name="first_name">
                            </div>
                            <div class="col-md-6">
                                <label for="last_name" class="form-label">Last Name</label>
                                <input type="text" class="form-control" id="last_name" name="last_name">
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="username" class="form-label">Username</label>
                                <input type="text" class="form-control" id="username" name="username">
                                <div class="form-text">Optional display username</div>
                            </div>
                            <div class="col-md-6">
                                <label for="full_name" class="form-label">Full Name (Display)</label>
                                <input type="text" class="form-control" id="full_name" name="full_name">
                                <div class="form-text">Name shown in header welcome message</div>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="access_level" class="form-label">Access Level</label>
                                <select class="form-select" id="access_level" name="access_level">
                                    <option value="full">Full Access</option>
                                    <option value="view_only">View Only</option>
                                    <option value="restricted">Restricted</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="password" class="form-label">Password <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="password" name="password" required>
                                    <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-outline-primary" type="button" id="generatePassword">
                                        <i class="fas fa-random"></i> Generate
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Page Access Permissions Section -->
                        <div class="card mt-4" style="background: linear-gradient(135deg, #6f42c1 0%, #6610f2 100%);">
                            <div class="card-header text-white border-0">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h5 class="card-title mb-0 text-white">
                                            <i class="fas fa-shield-alt me-2"></i>Page Access Permissions
                                        </h5>
                                        <small class="text-light">Configure detailed access controls for system pages</small>
                                    </div>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <button type="button" class="btn btn-outline-light" onclick="selectAllPermissions()">
                                            <i class="fas fa-check-double me-1"></i>Select All
                                        </button>
                                        <button type="button" class="btn btn-outline-light" onclick="clearAllPermissions()">
                                            <i class="fas fa-times me-1"></i>Clear All
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body" style="background: white;">
                                <!-- Core System Pages -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <div class="card border-primary">
                                            <div class="card-header bg-primary text-white">
                                                <h6 class="mb-0"><i class="fas fa-home me-2"></i>Core System</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="dashboard" id="page_dashboard">
                                                    <label class="form-check-label w-100" for="page_dashboard">
                                                        <i class="fas fa-tachometer-alt me-2 text-primary"></i><strong>Dashboard</strong><br>
                                                        <small class="text-muted">Main system overview and statistics</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="settings" id="page_settings">
                                                    <label class="form-check-label w-100" for="page_settings">
                                                        <i class="fas fa-cog me-2 text-secondary"></i><strong>Settings</strong><br>
                                                        <small class="text-muted">System configuration and preferences</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="admin" id="page_admin">
                                                    <label class="form-check-label w-100" for="page_admin">
                                                        <i class="fas fa-user-shield me-2 text-danger"></i><strong>Admin Dashboard</strong><br>
                                                        <small class="text-muted">Complete system administration</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="card border-success">
                                            <div class="card-header bg-success text-white">
                                                <h6 class="mb-0"><i class="fas fa-file-alt me-2"></i>Forms & Documents</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="house_acknowledge" id="page_house_acknowledge">
                                                    <label class="form-check-label w-100" for="page_house_acknowledge">
                                                        <i class="fas fa-home me-2 text-success"></i><strong>House Acknowledge</strong><br>
                                                        <small class="text-muted">House acknowledgment forms</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="submissions" id="page_submissions">
                                                    <label class="form-check-label w-100" for="page_submissions">
                                                        <i class="fas fa-file-alt me-2 text-info"></i><strong>Submissions</strong><br>
                                                        <small class="text-muted">Form submissions and data</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="purchase_request" id="page_purchase_request">
                                                    <label class="form-check-label w-100" for="page_purchase_request">
                                                        <i class="fas fa-shopping-cart me-2 text-warning"></i><strong>Purchase Request</strong><br>
                                                        <small class="text-muted">Purchase requisitions and approvals</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Management & Operations -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <div class="card border-warning">
                                            <div class="card-header bg-warning text-dark">
                                                <h6 class="mb-0"><i class="fas fa-boxes me-2"></i>Asset & Inventory</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="asset_management" id="page_asset_management">
                                                    <label class="form-check-label w-100" for="page_asset_management">
                                                        <i class="fas fa-boxes me-2 text-warning"></i><strong>Asset Management</strong><br>
                                                        <small class="text-muted">Inventory and asset tracking</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="stock_report" id="page_stock_report">
                                                    <label class="form-check-label w-100" for="page_stock_report">
                                                        <i class="fas fa-warehouse me-2 text-info"></i><strong>Stock Report</strong><br>
                                                        <small class="text-muted">Stock and inventory reports</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="food_locker" id="page_food_locker">
                                                    <label class="form-check-label w-100" for="page_food_locker">
                                                        <i class="fas fa-utensils me-2 text-success"></i><strong>Food Locker Management</strong><br>
                                                        <small class="text-muted">Food locker rental management</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="card border-info">
                                            <div class="card-header bg-info text-white">
                                                <h6 class="mb-0"><i class="fas fa-clipboard-check me-2"></i>Inspections & Tracking</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="room_checklist" id="page_room_checklist">
                                                    <label class="form-check-label w-100" for="page_room_checklist">
                                                        <i class="fas fa-clipboard-check me-2 text-primary"></i><strong>Room Checklist</strong><br>
                                                        <small class="text-muted">Room inspection and maintenance</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="meter_reading" id="page_meter_reading">
                                                    <label class="form-check-label w-100" for="page_meter_reading">
                                                        <i class="fas fa-tachometer-alt me-2 text-success"></i><strong>Meter Reading</strong><br>
                                                        <small class="text-muted">Utility meter readings</small>
                                                    </label>
                                                </div>
                                                

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Resident & Staff Management -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <div class="card border-danger">
                                            <div class="card-header bg-danger text-white">
                                                <h6 class="mb-0"><i class="fas fa-users me-2"></i>Resident Management</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="resident_checkout" id="page_resident_checkout">
                                                    <label class="form-check-label w-100" for="page_resident_checkout">
                                                        <i class="fas fa-sign-out-alt me-2 text-danger"></i><strong>Resident Check-Out</strong><br>
                                                        <small class="text-muted">Resident check-out scanning and management</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="offense_records" id="page_offense_records">
                                                    <label class="form-check-label w-100" for="page_offense_records">
                                                        <i class="fas fa-exclamation-triangle me-2 text-warning"></i><strong>Offense Records</strong><br>
                                                        <small class="text-muted">Offense record management</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="fin_search" id="page_fin_search">
                                                    <label class="form-check-label w-100" for="page_fin_search">
                                                        <i class="fas fa-search me-2 text-info"></i><strong>FIN Search</strong><br>
                                                        <small class="text-muted">FIN number search functionality</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="card border-secondary">
                                            <div class="card-header bg-secondary text-white">
                                                <h6 class="mb-0"><i class="fas fa-tools me-2"></i>Utilities & Systems</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="qr_codes" id="page_qr_codes">
                                                    <label class="form-check-label w-100" for="page_qr_codes">
                                                        <i class="fas fa-qrcode me-2 text-primary"></i><strong>QR Codes</strong><br>
                                                        <small class="text-muted">QR code management and generation</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="page_access" value="msrf_management" id="page_msrf_management">
                                                    <label class="form-check-label w-100" for="page_msrf_management">
                                                        <i class="fas fa-clipboard-list me-2 text-success"></i><strong>MSRF Management</strong><br>
                                                        <small class="text-muted">MSRF request management</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Access Level Configuration -->
                                <div class="card border-dark mb-3">
                                    <div class="card-header bg-dark text-white">
                                        <h6 class="mb-0"><i class="fas fa-lock me-2"></i>Access Level Configuration</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="access_level" value="full" id="access_full" checked>
                                                    <label class="form-check-label" for="access_full">
                                                        <i class="fas fa-unlock text-success me-2"></i><strong>Full Access</strong><br>
                                                        <small class="text-muted">Can view and edit all permitted pages</small>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="access_level" value="view_only" id="access_view_only">
                                                    <label class="form-check-label" for="access_view_only">
                                                        <i class="fas fa-eye text-info me-2"></i><strong>View Only</strong><br>
                                                        <small class="text-muted">Can only view data, no editing allowed</small>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="access_level" value="restricted" id="access_restricted">
                                                    <label class="form-check-label" for="access_restricted">
                                                        <i class="fas fa-lock text-warning me-2"></i><strong>Restricted</strong><br>
                                                        <small class="text-muted">Limited access with custom restrictions</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Submit Button Section -->
                        <div class="text-end mt-4">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-user-plus me-2"></i>
                                Create User & Set Permissions
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Password visibility toggle
    document.getElementById('togglePassword').addEventListener('click', function() {
        const passwordField = document.getElementById('password');
        const icon = this.querySelector('i');
        if (passwordField.type === 'password') {
            passwordField.type = 'text';
            icon.className = 'fas fa-eye-slash';
        } else {
            passwordField.type = 'password';
            icon.className = 'fas fa-eye';
        }
    });

    // Generate random password
    document.getElementById('generatePassword').addEventListener('click', function() {
        const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
        let password = '';
        for (let i = 0; i < 12; i++) {
            password += charset.charAt(Math.floor(Math.random() * charset.length));
        }
        document.getElementById('password').value = password;
        document.getElementById('password').type = 'text';
        document.getElementById('togglePassword').querySelector('i').className = 'fas fa-eye-slash';
    });

    // Handle access level restrictions
    function updateFormAccess() {
        const currentAccessLevel = document.querySelector('input[name="access_level"]:checked').value;
        const isViewOnly = currentAccessLevel === 'view_only';
        
        // For view_only users, keep page access enabled but show they'll have view-only permissions
        if (isViewOnly) {
            // Keep page access checkboxes enabled so admin can select which pages to give access to
            document.querySelectorAll('input[name="page_access"]').forEach(function(element) {
                element.disabled = false;
            });
            
            // Show info message for view_only
            showViewOnlyInfo();
        } else {
            document.querySelectorAll('input[name="page_access"]').forEach(function(element) {
                element.disabled = false;
            });
            hideViewOnlyInfo();
        }
    }
    
    function showViewOnlyInfo() {
        let info = document.getElementById('viewOnlyInfo');
        if (!info) {
            info = document.createElement('div');
            info.id = 'viewOnlyInfo';
            info.className = 'alert alert-info mt-3';
            info.innerHTML = '<i class="fas fa-eye me-2"></i><strong>View Only Access:</strong> Select which pages this user can view. They will have read-only access and cannot create, edit, or delete data on selected pages.';
            document.querySelector('.card-body').appendChild(info);
        }
    }
    
    function hideViewOnlyInfo() {
        const info = document.getElementById('viewOnlyInfo');
        if (info) {
            info.remove();
        }
    }
    
    // Listen for access level changes
    document.querySelectorAll('input[name="access_level"]').forEach(function(radio) {
        radio.addEventListener('change', updateFormAccess);
    });
    
    // Initial setup
    updateFormAccess();
});

function selectAllPermissions() {
    document.querySelectorAll('input[name="page_access"]').forEach(function(checkbox) {
        if (!checkbox.disabled) {
            checkbox.checked = true;
        }
    });
}

function clearAllPermissions() {
    document.querySelectorAll('input[name="page_access"]').forEach(function(checkbox) {
        checkbox.checked = false;
    });
}
</script>
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="form_access" value="room_inventory" id="form_room_inventory">
                                                    <label class="form-check-label w-100" for="form_room_inventory">
                                                        <i class="fas fa-home me-2 text-primary"></i><strong>Room Inventory Checklist</strong><br>
                                                        <small class="text-muted">Access to room handover forms</small>
                                                    </label>
                                                </div>
                                                

                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="form_access" value="regulations" id="form_regulations">
                                                    <label class="form-check-label w-100" for="form_regulations">
                                                        <i class="fas fa-file-contract me-2 text-success"></i><strong>Regulations Forms</strong><br>
                                                        <small class="text-muted">Access rules and regulations</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="form_access" value="inspection" id="form_inspection">
                                                    <label class="form-check-label w-100" for="form_inspection">
                                                        <i class="fas fa-search me-2 text-info"></i><strong>Inspection Forms</strong><br>
                                                        <small class="text-muted">Facility inspection and maintenance</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="card border-success">
                                            <div class="card-header bg-success text-white">
                                                <h6 class="mb-0"><i class="fas fa-user-shield me-2"></i>Administrative Access</h6>
                                            </div>
                                            <div class="card-body p-3">
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="admin_access" value="full_admin" id="admin_full">
                                                    <label class="form-check-label w-100" for="admin_full">
                                                        <i class="fas fa-crown me-2 text-warning"></i><strong>Full Admin Access</strong><br>
                                                        <small class="text-muted">Complete system administration</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="admin_access" value="asset_management" id="admin_assets">
                                                    <label class="form-check-label w-100" for="admin_assets">
                                                        <i class="fas fa-boxes me-2 text-primary"></i><strong>Asset Management</strong><br>
                                                        <small class="text-muted">Inventory and asset tracking</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="admin_access" value="qr_management" id="admin_qr">
                                                    <label class="form-check-label w-100" for="admin_qr">
                                                        <i class="fas fa-qrcode me-2 text-info"></i><strong>QR Code Management</strong><br>
                                                        <small class="text-muted">Generate and manage QR codes</small>
                                                    </label>
                                                </div>
                                                
                                                <div class="form-check mb-3">
                                                    <input class="form-check-input" type="checkbox" name="admin_access" value="reports" id="admin_reports">
                                                    <label class="form-check-label w-100" for="admin_reports">
                                                        <i class="fas fa-chart-bar me-2 text-success"></i><strong>Reports & Analytics</strong><br>
                                                        <small class="text-muted">Data analytics and reporting</small>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Quick Access Options -->
                                <div class="alert alert-warning border-0" style="background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);">
                                    <h6 class="text-dark"><i class="fas fa-bolt me-2"></i>Quick Access Options</h6>
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-warning btn-sm" id="allFormsAccess">
                                            <i class="fas fa-check-double me-1"></i>All Forms Access
                                        </button>
                                        <button type="button" class="btn btn-info btn-sm" id="viewOnlyAccess">
                                            <i class="fas fa-eye me-1"></i>View Only Access
                                        </button>
                                        <button type="button" class="btn btn-secondary btn-sm" id="clearAllAccess">
                                            <i class="fas fa-times me-1"></i>Clear All
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-end mt-4">
                            <button type="button" class="btn btn-secondary me-2" onclick="window.location.href='/admin'">
                                <i class="fas fa-times me-1"></i>Cancel
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-user-plus me-1"></i>Create User
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Password visibility toggle
    document.getElementById('togglePassword').addEventListener('click', function() {
        const passwordField = document.getElementById('password');
        const icon = this.querySelector('i');
        if (passwordField.type === 'password') {
            passwordField.type = 'text';
            icon.className = 'fas fa-eye-slash';
        } else {
            passwordField.type = 'password';
            icon.className = 'fas fa-eye';
        }
    });

    // Generate password
    document.getElementById('generatePassword').addEventListener('click', function() {
        const newPassword = generateSecurePassword();
        document.getElementById('password').value = newPassword;
        document.getElementById('password').type = 'text';
    });

    // Form access quick buttons
    document.getElementById('allFormsAccess').addEventListener('click', function() {
        document.querySelectorAll('input[name="form_access"]').forEach(function(checkbox) {
            checkbox.checked = true;
        });
        document.querySelectorAll('input[name="admin_access"]').forEach(function(checkbox) {
            checkbox.checked = true;
        });
    });

    document.getElementById('viewOnlyAccess').addEventListener('click', function() {
        document.querySelectorAll('input[name="form_access"]').forEach(function(checkbox) {
            checkbox.checked = true;
        });
        document.querySelectorAll('input[name="admin_access"]').forEach(function(checkbox) {
            if (checkbox.value !== 'full_admin') {
                checkbox.checked = false;
            }
        });
    });

    document.getElementById('clearAllAccess').addEventListener('click', function() {
        document.querySelectorAll('input[name="form_access"]').forEach(function(checkbox) {
            checkbox.checked = false;
        });
        document.querySelectorAll('input[name="admin_access"]').forEach(function(checkbox) {
            checkbox.checked = false;
        });
    });

    // Access level change handler
    document.getElementById('access_level').addEventListener('change', function() {
        if (this.value === 'view_only') {
            document.querySelectorAll('input[name="page_edit"]').forEach(function(checkbox) {
                checkbox.checked = false;
                checkbox.disabled = true;
            });
        } else {
            document.querySelectorAll('input[name="page_edit"]').forEach(function(checkbox) {
                checkbox.disabled = false;
            });
        }
    });

    // Auto-generate full name from first and last name
    function updateFullName() {
        const firstName = document.getElementById('first_name').value;
        const lastName = document.getElementById('last_name').value;
        const fullNameField = document.getElementById('full_name');
        
        if (firstName || lastName) {
            fullNameField.value = (firstName + ' ' + lastName).trim();
        }
    }

    document.getElementById('first_name').addEventListener('input', updateFullName);
    document.getElementById('last_name').addEventListener('input', updateFullName);
});

function generateSecurePassword() {
    const length = 12;
    const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";
    let password = "";
    for (let i = 0; i < length; i++) {
        password += charset.charAt(Math.floor(Math.random() * charset.length));
    }
    return password;
}
</script>
{% endblock %}